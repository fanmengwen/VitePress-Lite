# ğŸ“– VitePress-Lite å‰ç«¯æ–‡æ¡£ç«™ç‚¹

> åŸºäº Vue 3 + Vite çš„ç°ä»£åŒ–æ–‡æ¡£ç«™ç‚¹ï¼Œé€šè¿‡è‡ªå®šä¹‰æ’ä»¶å®ç° Markdown åˆ° Vue SFC çš„å®æ—¶è½¬æ¢

## ğŸ¯ æ ¸å¿ƒç†å¿µ

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ª**æ··åˆæ¸²æŸ“æ¶æ„**ï¼Œå°†æ–‡ä»¶ç³»ç»Ÿçš„ç‰ˆæœ¬ç®¡ç†ä¼˜åŠ¿ä¸æ•°æ®åº“çš„åŠ¨æ€åŠŸèƒ½å®Œç¾ç»“åˆï¼š

- **é™æ€å†…å®¹**ï¼šMarkdown æ–‡ä»¶é€šè¿‡ Vite æ’ä»¶å®æ—¶è½¬æ¢ä¸º Vue ç»„ä»¶
- **åŠ¨æ€å…ƒæ•°æ®**ï¼šä½œè€…ä¿¡æ¯ã€å‘å¸ƒçŠ¶æ€ç­‰é€šè¿‡ API ä»æ•°æ®åº“è·å–
- **å¼€å‘ä½“éªŒ**ï¼šæ”¯æŒ HMR çƒ­æ›´æ–°ï¼Œæ–‡æ¡£ä¿®æ”¹ç«‹å³å¯è§

## ğŸ”Œ è‡ªå®šä¹‰ Vite æ’ä»¶ç³»ç»Ÿ

### 1. Markdown è½¬æ¢æ’ä»¶ (`markdown-transformer-plugin.js`)

**æ ¸å¿ƒåŠŸèƒ½**ï¼šå°† `.md` æ–‡ä»¶è½¬æ¢ä¸º Vue å•æ–‡ä»¶ç»„ä»¶

```javascript
// å·¥ä½œæµç¨‹
.md æ–‡ä»¶ â†’ gray-matter è§£æ â†’ markdown-it æ¸²æŸ“ â†’ Vue SFC æ¨¡æ¿ â†’ çƒ­æ›´æ–°
```

**å…³é”®ç‰¹æ€§**ï¼š

- **Frontmatter è§£æ**ï¼šæå–æ–‡ç« å…ƒæ•°æ®ï¼ˆæ ‡é¢˜ã€ä½œè€…ã€æ—¥æœŸç­‰ï¼‰
- **è‡ªåŠ¨æ³¨å…¥ç»„ä»¶**ï¼šæ¯ä¸ªé¡µé¢è‡ªåŠ¨åŒ…å« `GlobalNav` å¯¼èˆªç»„ä»¶
- **HMR æ”¯æŒ**ï¼šæ–‡ä»¶ä¿®æ”¹æ—¶è§¦å‘ WebSocket äº‹ä»¶ï¼Œå®ç°çƒ­æ›´æ–°
- **æ’ä»¶æ‰©å±•**ï¼šæ”¯æŒ markdown-it æ’ä»¶ï¼Œå¦‚ `markdown-it-anchor` ç”Ÿæˆé”šç‚¹

**é…ç½®ç¤ºä¾‹**ï¼š

```javascript
markdownTransformerPlugin({
  markdownItOptions: {
    html: true, // å…è®¸ HTML æ ‡ç­¾
    linkify: true, // è‡ªåŠ¨é“¾æ¥åŒ– URL
  },
  markdownItPlugins: [
    [
      markdownItAnchor,
      {
        permalink: true,
        permalinkSymbol: "#",
      },
    ],
  ],
});
```

### 2. è™šæ‹Ÿé¡µé¢æ’ä»¶ (`virtual-pages-plugin.js`)

**æ ¸å¿ƒåŠŸèƒ½**ï¼šè‡ªåŠ¨æ‰«æ `docs/` ç›®å½•ï¼Œç”Ÿæˆè™šæ‹Ÿè·¯ç”±æ¨¡å—

```javascript
// ç”Ÿæˆçš„è™šæ‹Ÿæ¨¡å—ï¼švirtual:pages
export const routes = [
  { path: "/unit/unit1", component: () => import("virtual:md:unit/unit1.md") },
  { path: "/unit/unit2", component: () => import("virtual:md:unit/unit2.md") },
  // ...æ›´å¤šè·¯ç”±
];
```

**æ™ºèƒ½è·¯å¾„æ˜ å°„**ï¼š

```
æ–‡ä»¶è·¯å¾„                   â†’ è·¯ç”±è·¯å¾„
docs/total.md             â†’ /total
docs/unit/unit1.md        â†’ /unit/unit1
docs/advanced/æ¦‚å¿µ.md      â†’ /advanced/æ¦‚å¿µ
```

**åŠ¨æ€å¯¼å…¥ä¼˜åŒ–**ï¼šæ¯ä¸ªé¡µé¢æŒ‰éœ€åŠ è½½ï¼Œæå‡åˆå§‹åŠ è½½æ€§èƒ½

## ğŸ—ï¸ æ··åˆæ¸²æŸ“æ¶æ„

### é¡µé¢æ¸²æŸ“æµç¨‹

```mermaid
graph LR
    A[Markdown æ–‡ä»¶] --> B[Vite æ’ä»¶è½¬æ¢]
    B --> C[Vue SFC ç»„ä»¶]
    C --> D[é™æ€å†…å®¹æ¸²æŸ“]
    E[API è¯·æ±‚] --> F[æ•°æ®åº“æŸ¥è¯¢]
    F --> G[åŠ¨æ€å…ƒæ•°æ®]
    D --> H[å®Œæ•´é¡µé¢]
    G --> H
```

### æ•°æ®è·å–ç­–ç•¥

**é™æ€æ•°æ®**ï¼ˆæ¥è‡ªæ–‡ä»¶ï¼‰ï¼š

- Markdown å†…å®¹ä¸»ä½“
- Frontmatter åŸºç¡€ä¿¡æ¯
- å®æ—¶ HMR æ›´æ–°

**åŠ¨æ€æ•°æ®**ï¼ˆæ¥è‡ª APIï¼‰ï¼š

- ä½œè€…è¯¦ç»†ä¿¡æ¯ï¼ˆå¤´åƒã€é‚®ç®±ï¼‰
- ç²¾ç¡®çš„åˆ›å»º/æ›´æ–°æ—¶é—´
- å‘å¸ƒçŠ¶æ€å’Œæ–‡ç« ç»Ÿè®¡
- ç”¨æˆ·ç›¸å…³çš„ä¸ªæ€§åŒ–æ•°æ®

### ä¼˜é›…é™çº§æœºåˆ¶

```typescript
// ç¤ºä¾‹ï¼šç»„åˆé™æ€å’ŒåŠ¨æ€æ•°æ®
const pageData = {
  // é™æ€æ•°æ®ï¼ˆæ€»æ˜¯å¯ç”¨ï¼‰
  title: frontmatter.title,
  content: markdownContent,

  // åŠ¨æ€æ•°æ®ï¼ˆå¯èƒ½å¤±è´¥ï¼‰
  author: await fetchAuthor(frontmatter.author).catch(() => null),
  publishedAt: await fetchPublishTime(slug).catch(() => frontmatter.date),
};
```

å½“ API å¤±è´¥æ—¶ï¼Œé¡µé¢ä»èƒ½æ­£å¸¸æ˜¾ç¤ºé™æ€å†…å®¹ï¼Œä¿è¯åŸºæœ¬åŠŸèƒ½ä¸å—å½±å“ã€‚

## ğŸ§© ç»„ä»¶ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒç»„ä»¶

**`GlobalNav.vue`** - å…¨å±€å¯¼èˆªç»„ä»¶

- è‡ªåŠ¨æ‰«ææ‰€æœ‰å¯ç”¨é¡µé¢
- æ”¯æŒåµŒå¥—è·¯ç”±æ˜¾ç¤º
- å½“å‰é¡µé¢é«˜äº®
- å“åº”å¼æŠ˜å èœå•

**`MarkdownList.vue`** - æ–‡æ¡£åˆ—è¡¨ç»„ä»¶

- å±•ç¤ºæ–‡æ¡£é›†åˆ
- æ”¯æŒè¿‡æ»¤å’Œæœç´¢
- å¡ç‰‡å¼å¸ƒå±€

**`MarkdownCard.vue`** - æ–‡æ¡£å¡ç‰‡ç»„ä»¶

- æ˜¾ç¤ºæ–‡æ¡£æ‘˜è¦ä¿¡æ¯
- æ”¯æŒæ ‡ç­¾å’Œå…ƒæ•°æ®å±•ç¤º
- é“¾æ¥åˆ°è¯¦ç»†é¡µé¢

### çŠ¶æ€ç®¡ç†

ä½¿ç”¨ Vue 3 çš„ç»„åˆå¼ API å’Œ Piniaï¼š

```typescript
// composables/usePostsData.ts
export const usePostsData = () => {
  const posts = ref([]);
  const loading = ref(false);

  const fetchPosts = async () => {
    // æ··åˆæ•°æ®è·å–é€»è¾‘
  };

  return { posts, loading, fetchPosts };
};
```

## ğŸ› ï¸ å¼€å‘å·¥ä½œæµ

### æœ¬åœ°å¼€å‘

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev

# è®¿é—®åº”ç”¨
http://localhost:5173
```

**å¼€å‘æ—¶çš„å®Œæ•´æµç¨‹**ï¼š

1. **ç¼–è¾‘ Markdown**ï¼šåœ¨ `docs/` ç›®å½•ä¸‹ä¿®æ”¹ `.md` æ–‡ä»¶
2. **å®æ—¶é¢„è§ˆ**ï¼šVite HMR è‡ªåŠ¨æ›´æ–°é¡µé¢å†…å®¹
3. **åŒæ­¥æ•°æ®åº“**ï¼šè¿è¡Œ `pnpm db:sync` åŒæ­¥å…ƒæ•°æ®
4. **æŸ¥çœ‹æ•ˆæœ**ï¼šåˆ·æ–°é¡µé¢çœ‹åˆ°é™æ€+åŠ¨æ€çš„å®Œæ•´æ¸²æŸ“

### æ·»åŠ æ–°æ–‡æ¡£

1. åœ¨ `docs/` ä¸‹åˆ›å»º `.md` æ–‡ä»¶ï¼š

```markdown
---
title: "æ–°æ–‡æ¡£æ ‡é¢˜"
author: "ä½œè€…é‚®ç®±"
date: "2025-01-01"
published: true
---

# æ–‡æ¡£å†…å®¹

è¿™é‡Œæ˜¯ä½ çš„ Markdown å†…å®¹...
```

2. æ–‡ä»¶ä¿å­˜åè‡ªåŠ¨ç”Ÿæˆè·¯ç”±
3. åœ¨å¯¼èˆªä¸­å¯è§æ–°é¡µé¢
4. è¿è¡ŒåŒæ­¥å‘½ä»¤æ›´æ–°æ•°æ®åº“

### è‡ªå®šä¹‰ä¸»é¢˜

**å…¨å±€æ ·å¼**ï¼šä¿®æ”¹ `src/style.css`

```css
:root {
  --primary-color: #42b983; /* ä¸»é¢˜è‰² */
  --bg-color: #ffffff; /* èƒŒæ™¯è‰² */
  --text-color: #2c3e50; /* æ–‡å­—è‰² */
}
```

**ç»„ä»¶æ ·å¼**ï¼šä½¿ç”¨ Scoped CSS

```vue
<style scoped>
.markdown-content {
  max-width: 800px;
  margin: 0 auto;
  line-height: 1.7;
}
</style>
```

## âš™ï¸ é…ç½®è¯´æ˜

### Vite é…ç½® (`vite.config.ts`)

```typescript
export default defineConfig({
  plugins: [
    inspect(), // è°ƒè¯•å·¥å…·
    markdownTransformerPlugin(), // MD è½¬æ¢
    vue({ include: [/\.vue$/, /\.md$/] }),
    virtualPagesPlugin(), // è™šæ‹Ÿè·¯ç”±
  ],
  server: {
    port: 5173,
    proxy: {
      "/api": "http://localhost:3001", // API ä»£ç†
    },
  },
});
```

### è·¯ç”±é…ç½® (`src/router/index.ts`)

- é™æ€è·¯ç”±ï¼šæ‰‹åŠ¨å®šä¹‰çš„ç‰¹æ®Šé¡µé¢
- åŠ¨æ€è·¯ç”±ï¼šé€šè¿‡è™šæ‹Ÿæ¨¡å—è‡ªåŠ¨ç”Ÿæˆ
- 404 å¤„ç†ï¼šæœªåŒ¹é…è·¯ç”±çš„é™çº§é¡µé¢

## ğŸ” è°ƒè¯•ä¸ä¼˜åŒ–

### å¼€å‘å·¥å…·

- **Vite Inspector**ï¼šå¯è§†åŒ–æ¨¡å—ä¾èµ–å›¾
- **Vue DevTools**ï¼šç»„ä»¶çŠ¶æ€è°ƒè¯•
- **Network Tab**ï¼šAPI è¯·æ±‚ç›‘æ§

### æ€§èƒ½ä¼˜åŒ–

- **è·¯ç”±æ‡’åŠ è½½**ï¼šæ¯ä¸ªé¡µé¢æŒ‰éœ€åŠ è½½
- **ç»„ä»¶ç¼“å­˜**ï¼šä½¿ç”¨ `keep-alive` ç¼“å­˜é¡µé¢çŠ¶æ€
- **API ç¼“å­˜**ï¼šé¿å…é‡å¤çš„æ•°æ®åº“æŸ¥è¯¢
- **é™æ€èµ„æºä¼˜åŒ–**ï¼šVite è‡ªåŠ¨è¿›è¡Œä»£ç åˆ†å‰²

## ğŸš€ æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°çš„ Markdown æ’ä»¶

```javascript
// vite.config.ts
markdownTransformerPlugin({
  markdownItPlugins: [
    [require("markdown-it-katex")], // æ•°å­¦å…¬å¼
    [require("markdown-it-footnote")], // è„šæ³¨
    [require("markdown-it-container")], // è‡ªå®šä¹‰å®¹å™¨
  ],
});
```

### è‡ªå®šä¹‰é¡µé¢ç±»å‹

1. åœ¨ `src/pages/` æ·»åŠ æ–°ç»„ä»¶
2. åœ¨è·¯ç”±é…ç½®ä¸­æ³¨å†Œ
3. æ›´æ–°å¯¼èˆªé€»è¾‘ä»¥æ”¯æŒæ–°é¡µé¢

### å›½é™…åŒ–æ”¯æŒ

é¡¹ç›®ç»“æ„å·²ä¸ºå›½é™…åŒ–åšå¥½å‡†å¤‡ï¼š

```
docs/
â”œâ”€â”€ zh/           # ä¸­æ–‡æ–‡æ¡£
â”œâ”€â”€ en/           # è‹±æ–‡æ–‡æ¡£
â””â”€â”€ shared/       # å…±äº«èµ„æº
```

## ğŸ“¦ æ„å»ºä¸éƒ¨ç½²

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
# ç±»å‹æ£€æŸ¥ + æ„å»º
pnpm build

# é¢„è§ˆæ„å»ºç»“æœ
pnpm preview
```

### éƒ¨ç½²é…ç½®

ç”Ÿæˆçš„ `dist/` ç›®å½•åŒ…å«æ‰€æœ‰é™æ€èµ„æºï¼Œå¯éƒ¨ç½²åˆ°ä»»ä½•é™æ€æ‰˜ç®¡æœåŠ¡ï¼š

- **Netlify/Vercel**ï¼šé›¶é…ç½®éƒ¨ç½²
- **GitHub Pages**ï¼šé€šè¿‡ Actions è‡ªåŠ¨éƒ¨ç½²
- **CDN**ï¼šé…åˆ API æœåŠ¡å™¨çš„æ··åˆéƒ¨ç½²

---

## ğŸ”— ç›¸å…³é“¾æ¥

- **åç«¯ API æ–‡æ¡£**ï¼š[../api-server/README.md](../api-server/README.md)
- **é¡¹ç›®æ€»è§ˆ**ï¼š[../../README.md](../../README.md)
- **Vue 3 æ–‡æ¡£**ï¼šhttps://vuejs.org/
- **Vite æ’ä»¶å¼€å‘**ï¼šhttps://vitejs.dev/guide/api-plugin.html
